<!--
    EURORA test suite
    JUBE benchmark configuration schema for: RayBen
-->

<bench name    = "RayBen" platform= "Intel-SandyBridge-JUROPA3" >

<!-- ********************************************************** -->
<!-- Setup : Small (N1=193,N2=97,N3=129)                       -->
<!-- ********************************************************** -->

<benchmark name="small_pure_MPI" active="0">

    <compile     cname          = "$platform" 
                 version        = "new"
		 n1             = "$N1"
		 n2             = "$N2"
		 n3             = "$N3"/>

    <tasks       threadspertask = "1"
                 taskspernode   = "16"
                 nodes          = "6" />

    <params      descript          = "Setup: Small Pure MPI"
                 optflagsmic       = "-mmic -openmp -O3 -r8"
                 ldoptflagsmic     = "-mmic -mkl=parallel -liomp5"
                 optflagshost      = "-openmp -r8 -O3 -axSSE4.1 -ipo -m64 -align rec8byte"
                 ldoptflagshost    = "-mkl=parallel -liomp5"
                 N1             = "193"
                 N2             = "97"
                 N3             = "129"
                 NTST           = "10"
                 NSON           = "0"
	         targethost     = "host"
	         targetmic      = "mic"
		 ntasks_mic     = "0"
		 nmicthreads    = "240"
		 micnumperhost  = "1"
		 ntasks         = "`$nodes*$taskspernode`"/>

    <prepare     cname          = "small" />

    <execution   cname                 = "$platform"
                 walltime              = "00:30:00"
                 iteration             = "1" 
		 host                  = "j3c059-mic0" 
		 partition             = "q_mics" />

    <verify      cname          = "standard" />

    <analyse     cname          = "standard" />

</benchmark>

<!-- ********************************************************** -->

<!-- ********************************************************** -->
<!-- Setup : Medium (N1=721,N2=361,N3=621)                       -->
<!-- ********************************************************** -->
<benchmark name="medium_pure_MPI" active="0">

    <compile     cname          = "$platform" 
                 version        = "new"
		 n1             = "$N1"
		 n2             = "$N2"
		 n3             = "$N3"/>

    <tasks       threadspertask = "1"
                 taskspernode   = "12"
                 nodes          = "30" />

    <params      descript          = "Setup: Medium Pure MPI"
		 optflagsmic       = "-mmic -openmp -O3 -r8"
                 ldoptflagsmic     = "-mmic -mkl=parallel -liomp5"
                 optflagshost      = "-openmp -r8 -O3 -axSSE4.1 -ipo -m64 -align rec8byte"
                 ldoptflagshost    = "-mkl=parallel -liomp5"
                 N1             = "721"
                 N2             = "361"
                 N3             = "621"
                 NTST           = "10"
                 NSON           = "0"
		 targethost     = "host"
	         targetmic      = "mic"
		 ntasks_mic     = "0"
		 nmicthreads    = "240"
		 micnumperhost  = "1"
		 ntasks         = "`$nodes*$taskspernode`"/>

    <prepare     cname          = "medium" />

    <execution   cname          = "$platform"
                 walltime       = "00:30:00"
                 iteration      = "1" 
		 host           = "j3c059-mic0" 
		 partition      = "q_mics" />

    <verify      cname          = "standard" />

    <analyse     cname          = "standard" />

</benchmark>

<!-- ********************************************************** -->

<!-- ********************************************************** -->
<!-- Setup : Big (N1=1201,N2=513,N3=1025)                       -->
<!-- ********************************************************** -->
<benchmark name="big_pure_MPI" active="0">

    <compile     cname          = "$platform" 
                 version        = "new"
		 n1             = "$N1"
		 n2             = "$N2"
		 n3             = "$N3"/>

    <tasks       threadspertask = "1"
                 taskspernode   = "8"
                 nodes          = "64" />

    <params      descript       = "Setup: Big Pure MPI"
                 optflagsmic    = "-mmic -openmp -O3 -r8"
                 ldoptflagsmic  = "-mmic -mkl=parallel -liomp5"
                 optflagshost   = "-openmp -r8 -O3 -axSSE4.1 -ipo -m64 -align rec8byte"
                 ldoptflagshost = "-mkl=parallel -liomp5"
                 N1             = "1201"
                 N2             = "513"
                 N3             = "1025"
                 NTST           = "10"
                 NSON           = "0"
	         targethost     = "host"
	         targetmic      = "mic"
		 ntasks_mic     = "0"
		 nmicthreads    = "240"
		 micnumperhost  = "1"
		 ntasks         = "`$nodes*$taskspernode`"/>

    <prepare     cname          = "big" />

    <execution   cname          = "$platform"
                 walltime       = "00:30:00"
                 iteration      = "1" 
		 host           = "j3c059-mic0" 
		 partition      = "q_mics" />

    <verify      cname          = "standard" />

    <analyse     cname          = "standard" />

</benchmark>

<!-- ********************************************************** -->

<!-- ********************************************************** -->
<!-- Setup : Small (N1=193,N2=97,N3=129) Hybrid                 -->
<!-- ********************************************************** -->
<!-- ### -->
<benchmark name="small_Hybrid" active="1">

  <compile     cname          = "$platform"
               version        = "reuse"
	       n1             = "$N1"
	       n2             = "$N2"
	       n3             = "$N3" />


    <tasks       threadspertask = "2"
                 taskspernode   = "6"
                 nodes          = "1" />
  <!-- micnumperhost must be 0 for host only run -->              
    <params      descript          = "Setup: Small Hybrid"
                 optflagsmic       = "-mmic -openmp -O3 -r8"
                 ldoptflagsmic     = "-mmic -mkl=parallel -liomp5"
                 optflagshost      = "-openmp -r8 -O3 -axSSE4.1 -ipo -m64 -align rec8byte"
                 ldoptflagshost    = "-mkl=parallel -liomp5"
                 N1             = "193"
                 N2             = "97"
                 N3             = "129"
                 NTST           = "10"
                 NSON           = "0"
	         targethost     = "host"
	         targetmic      = "mic"
		 ntasks_mic     = "0"
		 nmicthreads    = "240"
		 micnumperhost  = "0"
		 ntasks         = "`$nodes*$taskspernode`"/>

    <prepare     cname          = "small" />

    <execution   cname          = "$platform"
                 walltime       = "00:30:00"
                 iteration      = "1" 
		 host           = "j3c059-mic0" 
		 partition      = "q_mics" />
	

    <verify      cname          = "standard" />

    <analyse     cname          = "standard" />

</benchmark>

<!-- ********************************************************** -->

<!-- ********************************************************** -->
<!-- ********************************************************** -->
<!-- Setup : Medium (N1=721,N2=361,N3=621) Hybrid               -->
<!-- ********************************************************** -->
<benchmark name="medium_Hybrid" active="0">

    <compile     cname          = "$platform" 
                 version        = "new"
		 n1             = "$N1"
		 n2             = "$N2"
		 n3             = "$N3"/>

    <tasks       threadspertask = "12"
                 taskspernode   = "1"
                 nodes          = "30" />

    <params      descript       = "Setup: Medium Hybrid"
                 optflagsmic    = "-mmic -openmp -O3 -r8"
                 ldoptflagsmic  = "-mmic -mkl=parallel -liomp5"
                 optflagshost   = "-openmp -r8 -O3 -axSSE4.1 -ipo -m64 -align rec8byte"
                 ldoptflagshost = "-mkl=parallel -liomp5"
                 N1             = "721"
                 N2             = "361"
                 N3             = "621"
                 NTST           = "10"
                 NSON           = "0"
	         targethost     = "host"
	         targetmic      = "mic"
		 ntasks_mic     = "0"
		 nmicthreads    = "240"
		 micnumperhost  = "1"
		 ntasks         = "`$nodes*$taskspernode`"/>

    <prepare     cname          = "medium" />

    <execution   cname          = "$platform"
                 walltime       = "00:30:00"
                 iteration      = "1" 
		 host           = "j3c059-mic0" 
		 partition      = "q_mics" />
    
    <verify      cname          = "standard" />

    <analyse     cname          = "standard" />

</benchmark>

<!-- ********************************************************** -->

<!-- ********************************************************** -->
<!-- Setup : Big (N1=1201,N2=513,N3=1025) Hybrid                -->
<!-- ********************************************************** -->
<benchmark name="big_Hybrid" active="0">

    <compile     cname          = "$platform" 
                 version        = "new"
		 n1             = "$N1"
		 n2             = "$N2"
		 n3             = "$N3"/>

    <tasks       threadspertask = "2"
                 taskspernode   = "4"
                 nodes          = "64" />

    <params      descript       = "Setup: Big Hybrid"
                 optflagsmic    = "-mmic -openmp -O3 -r8"
                 ldoptflagsmic  = "-mmic -mkl=parallel -liomp5"
                 optflagshost   = "-openmp -r8 -O3 -axSSE4.1 -ipo -m64 -align rec8byte"
                 ldoptflagshost = "-mkl=parallel -liomp5"
                 N1             = "1201"
                 N2             = "513"
                 N3             = "1025"
                 NTST           = "10"
                 NSON           = "0"
	         targethost     = "host"
	         targetmic      = "mic"
		 ntasks_mic     = "0"
		 nmicthreads    = "240"
		 micnumperhost  = "1"
		 ntasks         = "`$nodes*$taskspernode`"/>

    <prepare     cname          = "big" />

    <execution   cname          = "$platform"
                 walltime       = "00:30:00"
                 iteration      = "1" 
		 host           = "j3c059-mic0" 
		 partition      = "q_mics" />
 
    <verify      cname          = "standard" />

    <analyse     cname          = "standard" />

</benchmark>

<!-- ********************************************************** -->

</bench>
