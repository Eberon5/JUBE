{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "JUBE",
  "description": "JUBE benchmark definition",



  "properties": {
    "name": {
      "description": "unique name of the benchmark",
      "type": "string"
    },
    "outpath": {        
      "description": "contains the path to the root folder for benchmark runs",
      "type": "string"
    },
    "comment": {
      "description": "Add a benchmark specific comment. These comment will be stored inside the benchmark directory.",
      "type": "string"
    },
    "file_path_ref": {
      "description": "unknown functionality",
      "type": "string"
    },
    "tag": {
      "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
      "type": "string"
    },



    "parameterset": {
      "description": "A parameterset is a container to store a bundle of *parameters*",
      "type": [ "object","array" ],
      "properties": {
        "name": {
          "description": "unique name of the parameterset",
          "type": "string"
        },
        "init_with": {
          "description": "import parameters",
          "type": "string"
        },
        "duplicate": {
          "description": "duplicate is of relevance, if there are more than one parameter definitions with the same name within one parameterset.",
          "type": "string",
          "pattern": "^(replace|concat|error)$"
        },
        "tag": {
          "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
          "type": "string"
        },
        "parameter": {
          "description": "A parameter can be used to store benchmark configuration data. A set of different parameters will create a specific parameter environment (also called *parameter space*) for the different steps of the benchmark.",
          "type": [ "object","array" ],
          "properties": {
            "name": {
              "description": "name must be unique inside the given parameterset",
              "type": "string"
            },
            "type": {
              "description": "type is only used for sorting",
              "type": "string",
              "pattern": "^(string|int|float)$"
            },
            "mode": {
              "description": "mode is used for script-types",
              "type": "string",
              "pattern": "^(python|perl|shell|env|tag)$"
            },
            "export": {
              "description": "If export is set to true, the parameter will be exported to the shell environment when using *do*",
              "type": "boolean"
            },
            "duplicate": {
              "description": "duplicate is of relevance, if there are more than one parameter definitions with the same name within one parameterset.",
              "type": "string",
              "pattern": "^(none|replace|concat|error)$"
            },
            "update_mode": {
              "description": "Depending on the update_mode the parameter will be reevaluated",
              "type": "string",
              "pattern": "^(never|use|step|cycle|always)$"
            },
            "separator": {
              "description": "The default separator can be changed by using separator",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          },    
          "required": [ "name" ]    
        },
        "include": {
          "description": "include can be used to include an external XML-structure into the current file",
          "type": "object",
          "properties": {
            "from": {
              "description": "from is used to specify an external set source",
              "type": "string"
            },
            "path": {
              "description": "path can be used to give an alternative xml-path inside the include-file",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          },
          "required": [ "from" ]
        }
      },
      "required": [ "name" ]
    },



    "patternset": {
      "description": "A patternset is a container to store a bundle of patterns.",
      "type": [ "object","array" ],
      "properties": {
        "name": {
          "description": "unique name of the patternset",
          "type": "string"
        },
        "init_with": {
          "description": "If the given filepath can be found inside of the JUBE_INCLUDE_PATH and if it contains a patternset using the given name, all pattern will be copied to the local set.",
          "type": "string"
        },
        "tag": {
          "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
          "type": "string"
        },
        "pattern": {
          "description": "A pattern is used to parse your output files and create your result data.",
          "type": [ "object","array" ],
          "properties": {
            "name": {
              "description": "name must be unique",
              "type": "string"
            },
            "unit": {
              "description": "unit will be used in the result table",
              "type": "string"
            },
            "type": {
              "description": "type is only used for sorting",
              "type": "string",
              "pattern": "^(string|int|float)$"
            },
            "mode": {
              "description": "mode is used for script-types",
              "type": "string",
              "pattern": "^(python|perl|shell|env|tag)$"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            },
            "default": {
              "description": "Specify default value if pattern cannot be found or if it cannot be evaluated",
              "type": "string"
            },
            "dotall": {
              "description": "dotall can be used to specify if a '.' within the regular expression should also match newline characters.",
              "type": "boolean"
            }
          },
          "required": [ "name" ]
        },
        "include": {
          "description": "include can be used to include an external XML-structure into the current file",
          "type": [ "object","array" ],
          "properties": {
            "from": {
              "description": "from is used to specify an external set source",
              "type": "string"
            },
            "path": {
              "description": "path can be used to give an alternative xml-path inside the include-file",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          },
          "required": [ "from" ]
        }
      },
      "required": [ "name" ]
    },



    "substituteset": {
      "description": "A substituteset is a container to store a bundle of *sub* commands.",
      "type": [ "object","array" ],
      "properties": {
        "name": {
          "description": "name must be unique",
          "type": "string"
        },
        "init_with": {
          "description": "if the given filepath can be found inside of the JUBE_INCLUDE_PATH and if it contains a substituteset using the given name, all *iofile* and *sub* will be copied to the local set.",
          "type": "string"
        },
        "tag": {
          "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
          "type": "string"
        },
        "iofile": {
          "description": "A iofile declares the name (and path) of a file used for substitution.",
          "type": [ "object","array" ],
          "properties": {
            "in": {
              "description": "Relative filepath to the current work directory for every single step",
              "type": "string"
            },
            "out": {
              "description": "Relative filepath to the current work directory for every single step",
              "type": "string"
            },
            "out_mode": {
              "description": "out_mode can be used to declare, if the out-file will be overridden (w) or appended (a)",
              "type": "string",
              "pattern": "^(w|a)$"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          },
          "required": [ "in","out" ]
        },
        "sub": {
          "description": "A substition expression",
          "type": [ "object","array" ],
          "properties": {
            "source": {
              "description": "source-string will be replaced by dest-string",
              "type": "string"
            },
            "dest": {
              "description": "dest-string will replace the source-string",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          },
          "required": [ "source" ]
        },
        "include": {
          "description": "include can be used to include an external XML-structure into the current file",
          "type": [ "object","array" ],
          "properties": {
            "from": {
              "description": "from is used to specify an external set source",
              "type": "string"
            },
            "path": {
              "description": "path can be used to give an alternative xml-path inside the include-file",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          },
          "required": [ "from" ]
        }
      },
      "required": [ "name" ]
    },



    "fileset": {
      "description": "A fileset is a container to store a bundle of links and copy commands.",
      "type": [ "object","array" ],
      "properties": {
        "name": {
          "description": "name must be unique",
          "type": "string"
        },
        "init_with": {
          "description": "If the given filepath can be found inside of the JUBE_INCLUDE_PATH and if it contains a fileset using the given name, all *link* and *copy* will be copied to the local set",
          "type": "string"
        },
        "tag": {
          "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
          "type": "string"
        },
        "copy": {
          "description": "A copy can be used to copy a file or directory from your normal filesytem to your sandbox work directory.",
          "type": [ "object","array","string" ],
          "properties": {
            "directory": {
              "description": "unknown functionality",
              "type": "string"
            },
            "name": {
              "description": "name can be used to rename the file inside your work directory (will be ignored if you use shell extensions in your pathname)",
              "type": "string"
            },
            "rel_path_ref": {
              "description": "rel_path_ref declares, if relative paths will be based on the position of the JUBE-Skript (external) or the current work directory (internal).",
              "type": "string"
            },
            "file_path_ref": {
              "description": "unknown functionality",
              "type": "string"
            },
            "active": {
              "description": "active can be used to enable or disable the single command",
              "type": "string"
            },
            "source_dir": {
              "description": "source_dir will be used as a prefix for the source filenames",
              "type": "string"
            },
            "target_dir": {
              "description": "target_dir will be used as a prefix for the target filenames",
              "type": "string"
            },
            "separator": {
              "description": "separator can be used to change the default separator.",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          }
        },
        "link": {
          "description": "",
          "type": [ "object","array","string" ],
          "properties": {
            "directory": {
              "description": "unknown functionality",
              "type": "string"
            },
            "name": {
              "description": "name can be used to rename the file inside your work directory (will be ignored if you use shell extensions in your pathname)",
              "type": "string"
            },
            "rel_path_ref": {
              "description": "rel_path_ref declares, if relative paths will be based on the position of the JUBE-Skript (external) or the current work directory (internal).",
              "type": "string"
            },
            "file_path_ref": {
              "description": "unknown functionality",
              "type": "string"
            },
            "active": {
              "description": "active can be used to enable or disable the single command",
              "type": "string"
            },
            "source_dir": {
              "description": "source_dir will be used as a prefix for the source filenames",
              "type": "string"
            },
            "target_dir": {
              "description": "target_dir will be used as a prefix for the target filenames",
              "type": "string"
            },
            "separator": {
              "description": "separator can be used to change the default separator.",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          }
        },
        "prepare": {
          "description": "The prepare can contain any Shell command you want. It will be executed like a normal *do* inside the step where the corresponding fileset is used. The only difference towards the normal *do* is, that it will be executed before the substitution will be executed.",
          "type": [ "object","array","string" ],
          "properties": {
            "stdout": {
              "description": "standard out file",
              "type": "string"
            },
            "stderr": {
              "description": "standard error file",
              "type": "string"
            },
            "active": {
              "description": "active can be used to enable or disable the single command",
              "type": "string"
            },
            "work_dir": {
              "description": "work_dir can be used to change the work directory of this single command (relativly seen towards the original work directory).",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          }
        },
        "include": {
          "description": "include can be used to include an external XML-structure into the current file",
          "type": [ "object","array" ],
          "properties": {
            "from": {
              "description": "from is used to specify an external set source",
              "type": "string"
            },
            "path": {
              "description": "path can be used to give an alternative xml-path inside the include-file",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          },
          "required": [ "from" ]
        }
      },
      "required": [ "name" ]
    },



    "step": {
      "description": "A step gives a list of Shell operations and a corresponding parameter environment.",
      "type": [ "object","array" ],
      "properties": {
        "name": {
          "description": "name must be unique",
          "type": "string"
        },
        "iterations": {
          "description": "iterations can be used to execute all workpackages within this step multiple times.",
          "type": "integer"
        },
        "max_async": {
          "description": "max_async can contain a number (or a parameter) which describe how many workpackages can be executed asynchronously (default: 0 means no limitation). This option is only important if a do inside the step contains a done_file attribute and should be executed in the background (or managed by a jobsystem).",
          "type": "string"
        },
        "depend": {
          "description": "depend can contain a list of other step names which must be executed before the current step.",
          "type": "string"
        },
        "work_dir": {
          "description": "work_dir can be used to switch to an alternative work directory",
          "type": "string"
        },
        "active": {
          "description": "active can be used to enable or disable the single command",
          "type": "string"
        },
        "suffix": {
          "description": "suffix can contain a string (parameters are allowed) which will be attached to the default workpackage directory name.",
          "type": "string"
        },
        "export": {
          "description": "If export is set to true, the environment of the current step will be exported to an dependent step",
          "type": "boolean"
        },
        "shared": {
          "description": "shared can be used to create a shared folder which can be accessed by all workpackages based on this step",
          "type": "string"
        },
        "tag": {
          "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
          "type": "string"
        },
        "cycles": {
          "description": "cycles can be used to execute all *do* commands within the step multiple times.",
          "type": "integer"
        },
        "procs": {
          "description": "Amount of processes used to execute the parameter expansions of the corresponding step in parallel.",
          "type": "integer"
        },
        "do_log_file": {
          "description": "Name or path of a do log file trying to mimick the do steps and the environment of a workpacakge of a step to produce an executable script.",
          "type": "string"
        },
        "use": {
          "description": "use declares, which parametersets, filesets and substitutionsets are usable",
          "type": [ "object","array","string" ],
          "properties": {
            "from": {
              "description": "from can be used to specify an external set source",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          }
        },
        "do": {
          "description": "A do contains an executable Shell operation.",
          "type": [ "object","array","string" ],
          "properties": {
            "done_file": {
              "description": "By using done_file the user can mark async-steps. The operation will stop until the script will create the named file inside the work directory.",
              "type": "string"
            },
            "error_file": {
              "description": "By using error_file the operation will produce a error if the named file can be found inside the work directory.",
              "type": "string"
            },
            "break_file": {
              "description": "By using break_file the user can stop further cycle runs. the current step will be directly marked with finalized and further *do* will be ignored.",
              "type": "string"
            },
            "stdout": {
              "description": "standard out file",
              "type": "string"
            },
            "stderr": {
              "description": "standard error file",
              "type": "string"
            },
            "active": {
              "description": "active can be used to enable or disable the single command",
              "type": "string"
            },
            "shared": {
              "description": "If shared is set to true, the *do* will be executed inside the shared folder once (synchronize all workpackages).",
              "type": "boolean"
            },
            "work_dir": {
              "description": "work_dir can be used to change the work directory of this single command (relativly seen towards the original work directory).",
              "type": "string"
            }
          }
        },
        "include": {
          "description": "include can be used to include an external XML-structure into the current file",
          "type": [ "object","array" ],
          "properties": {
            "from": {
              "description": "from is used to specify an external set source",
              "type": "string"
            },
            "path": {
              "description": "path can be used to give an alternative xml-path inside the include-file",
              "type": "string"
            },
            "tag": {
              "description": "A tag can be used to mark parts of your input file to be includable or excludable.",
              "type": "string"
            }
          },
          "required": [ "from" ]
        }
      },
      "required": [ "name" ]
    },



    "analyser": {},
    "result": {},
    "include": {}
  },
  "required": [ "name", "outpath" ]
}